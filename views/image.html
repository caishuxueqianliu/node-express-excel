<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <title></title>
         <script type="text/javascript" src="./public/lib/jquery.js"></script>
        <link rel="stylesheet" href="./public/bootstrap3.3.7.css">
        <link rel="stylesheet" href="./public/lib/fileinput.min.css">    
        <script type="text/javascript" src="./public/lib/fileinput.min.js"></script>
      
    </head>

    <body>
   <div class="file-loading">
    <input id="input-ke-2" name="file" type="file" multiple>
</div>
    </body>

</html>

<script type="text/javascript">
 // 上传附件
 $("#input-ke-2")
      .fileinput({
        language: "zh", //设置语言
        uploadUrl:"http://localhost:3000/image", //上传的地址
        allowedFileExtensions: ["jpg", "png", "jpeg", "bmp"], //接收的文件后缀
        theme: "explorer-fa",     // 主题设置
        //initialPreview: url1 + filePath + fileName,        // 初始预览区域显示的图片
        initialPreviewAsData: true,
        initialPreviewConfig: [
          { type: "image", fileType: "image", caption: 'fileName' }
        ],
        dropZoneEnabled: false,          // 禁止点击预览区域进行文件上传操作
        maxFileCount: 6,                    // 最大上传为 1
        showUpload: true,             // 不显示上传按钮，选择后直接上传
        previewClass:"uploadPreview",
      })
    //   .on("change", function() {               
    //     // 清除掉上次上传的图片
    //     $(".uploadPreview").find(".file-preview-frame:first").remove();
    // $(".uploadPreview").find(".kv-zoom-cache:first").remove();
    //   })
    //   .on("filebatchselected", function(e, files) {        
    //     $(this).fileinput("upload");             // 文件选择完直接调用上传方法。
    //   })
      .on("fileuploaded", function(e, data, previewiId, index) {       // 上传完成后的处理
        var form = data.form,
          files = data.files,
          extra = data.extra,
          response = data.response,        // 响应
          reader = data.reader;          // 文件对象
        if (response.flag) {
          let img = new Image();     // 这里上传的是图片，对图片处理获取图片的分辨率
          img.src = reader.result;
          if (img.complete) {
            $(this).attr("data-displayReso", img.width + "*" + img.height);
          } else {
            img.onload = function() {
              $(this).attr("data-displayReso", img.width + "*" + img.height);
            };
          }
        }
      });
    // $("#input-ke-2").fileinput({
    //     language:'zh',                                          // 多语言设置，需要引入local中相应的js，例如locales/zh.js
    //     theme: "explorer-fa",                               // 主题
    //     uploadUrl: 'http://localhost:3000/image',         // 上传地址
    //     minFileCount: 1,                                        // 最小上传数量
    //     maxFileCount: 5,                                        // 最大上传数量
    //     overwriteInitial: false,                        // 覆盖初始预览内容和标题设置
    //     showCancel:false,                                       // 显示取消按钮
    //     showZoom:false,                                         // 显示预览按钮
    //     showCaption:false,                                  // 显示文件文本框
    //     dropZoneEnabled:false,                          // 是否可拖拽
    //     uploadLabel:"上传附件",                         // 上传按钮内容
    //     browseLabel: '选择附件',                            // 浏览按钮内容
    //     showRemove:false,                                       // 显示移除按钮
    //     browseClass:"layui-btn",                        // 浏览按钮样式
    //     uploadClass:"layui-btn",                        // 上传按钮样式
    //     //uploadExtraData: {'taskId':taskId,'createBy':userId,'createByname':username},   // 上传数据
    //     hideThumbnailContent:true,                  // 是否隐藏文件内容
    //     fileActionSettings: {                               // 在预览窗口中为新选择的文件缩略图设置文件操作的对象配置
    //         showRemove: true,                                   // 显示删除按钮
    //         showUpload: true,                                   // 显示上传按钮
    //         showDownload: false,                            // 显示下载按钮
    //         showZoom: false,                                    // 显示预览按钮
    //         showDrag: false,                                        // 显示拖拽
    //         showPreview: true,
    //         removeIcon: '<i class="fa fa-trash"></i>',   // 删除图标 
    //         uploadIcon: '<i class="fa fa-upload"></i>',     // 上传图标
    //         uploadRetryIcon: '<i class="fa fa-repeat"></i>'  // 重试图标
    //     },
    //     // initialPreview: [                                                                   //初始预览内容
    //     //     "https://picsum.photos/1920/1080?image=101",
    //     //     "https://picsum.photos/1920/1080?image=102",
    //     //     "https://picsum.photos/1920/1080?image=103"
    //     // ],
    //     // initialPreviewConfig: [                                                     // 初始预览配置 caption 标题，size文件大小 ，url 删除地址，key删除时会传这个
    //     //     {caption: "picture-1.jpg", size: 329892, width: "120px", url: task_file_delete_url, key: 101},
    //     //     {caption: "picture-2.jpg", size: 872378, width: "120px", url: task_file_delete_url, key: 102},
    //     //     {caption: "picture-3.jpg", size: 632762, width: "120px", url: task_file_delete_url, key: 103}
    //     // ]
    // });
    // // 上传成功回调
    // $("#input-ke-2").on("filebatchuploadcomplete", function() {
    //     layer.msg("上传附件成功");
    //     setTimeout("closeUpladLayer()",2000)
    // });
    // // 上传失败回调
    // $('#input-ke-2').on('fileerror', function(event, data, msg) {
    //     layer.msg(data.msg);
    //     tokenTimeOut(data);
    // });

</script>